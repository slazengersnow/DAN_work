# 月次詳細表示修正について

このドキュメントでは、月次詳細表示機能の問題と実装された修正について説明します。

## 修正内容

1. **実雇用率の計算精度向上**
   - 実雇用率の計算を小数点第1位切り上げから小数点第2位四捨五入に変更
   - 表示も小数点第2位まで表示することで正確さを向上

2. **法定雇用率の表示改善**
   - 法定雇用率の表示形式を小数点第2位で統一（例: 2.3 → 2.30）
   - 入力値の処理を改善し、常に2桁小数点で表示

3. **障がい者カウント計算の修正**
   - 1・2級パートタイムのカウント計算を修正（2 × 0.5 = 1カウント）
   - 実際の法定雇用カウント計算と一致するよう調整

4. **法定雇用者数計算方法の変更**
   - 法定雇用者数の計算を切り上げ（Math.ceil）から切り捨て（Math.floor）に変更
   - 新しい法令の計算方法に合わせて修正

5. **超過・不足計算の修正**
   - 超過・不足の合計欄計算を単純合計から正確な計算（合計障害者数 - 合計法定雇用者数）に修正
   - より正確な結果を表示

6. **小数点表示と入力処理の改善**
   - 1桁小数入力時の自動2桁変換機能を追加
   - 法定雇用率の入力と表示を一貫して正確に処理

## 修正ファイル

- `/frontend/src/pages/MonthlyReport/MonthlyReportDetail.tsx`

## 修正スクリプト

修正は以下の2つのスクリプトで行えます：

1. **fix-monthly-report-detail.js**
   - シンプルな一括置換を行う修正スクリプト
   - 基本的な問題を修正します

2. **monthly-report-fixes.js** (推奨)
   - より詳細な修正を行う包括的なスクリプト
   - 元ファイルのバックアップを作成します
   - 各修正の詳細なログを出力します

## 実行方法

```bash
# モジュールをインストール
npm install

# 修正スクリプトを実行
node monthly-report-fixes.js

# アプリケーションを再起動
npm start
```

## 影響範囲

この修正は月次詳細表示のみに影響し、以下の機能には影響しません：

- 従業員詳細タブ
- サマリータブ
- その他のメニュー・機能

## 確認方法

修正後、以下の点を確認してください：

1. 法定雇用率が小数点第2位まで正しく表示されること（例: 2.30%）
2. 実雇用率が小数点第2位まで正確に計算・表示されること
3. 障がい者合計のカウントが正しく計算されること
4. 法定雇用者数が切り捨てで計算されること
5. 超過・不足数が正確に計算されること

## トラブルシューティング

修正後に問題が発生した場合は、バックアップファイルを元に戻すことができます：

```bash
# バックアップから復元
cp backup/frontend/src/pages/MonthlyReport/MonthlyReportDetail.tsx frontend/src/pages/MonthlyReport/
```