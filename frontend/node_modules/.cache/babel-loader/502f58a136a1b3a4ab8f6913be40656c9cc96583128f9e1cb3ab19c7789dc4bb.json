{"ast":null,"code":"var _jsxFileName = \"/Users/gotouhiroaki/Programming/DAN_work/disability-employment-system/frontend/src/pages/MonthlyReport/index.tsx\",\n  _s2 = $RefreshSig$();\n// src/pages/MonthlyReport/index.tsx\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useQuery, useQueryClient } from 'react-query';\nimport SummaryTab from './SummaryTab';\nimport EmployeesTab from './EmployeesTab';\nimport MonthlyReportDetail from './MonthlyReportDetail';\nimport { YearMonthProvider, useYearMonth } from './YearMonthContext';\nimport { getMonthlyReport, getMonthlyReports, createMonthlyReport } from '../../api/reportApi';\nimport { safeNumber } from './utils';\nimport Spinner from '../../components/common/Spinner';\nimport ErrorMessage from '../../components/common/ErrorMessage';\nimport axios from 'axios';\nimport '../UIFixer.js'; // 従業員詳細と月次報告画面の年度表示最適化\n\n// API base URL \n// 開発環境ではproxy設定を使用するため、'/api'とする\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = process.env.NODE_ENV === 'development' ? '/api' : process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n\n// サンプル従業員データ（デフォルト表示用）\nconst sampleEmployees = [{\n  id: 1,\n  no: 1,\n  employee_id: '1001',\n  name: '山田 太郎',\n  disability_type: '身体障害',\n  disability: '視覚',\n  grade: '1級',\n  hire_date: '2020/04/01',\n  status: '在籍',\n  monthlyStatus: Array(12).fill(''),\n  memo: '',\n  count: 0\n}, {\n  id: 2,\n  no: 2,\n  employee_id: '2222',\n  name: '鈴木 花子',\n  disability_type: '身体障害',\n  disability: '聴覚',\n  grade: '4級',\n  hire_date: '2020/04/01',\n  status: '在籍',\n  monthlyStatus: Array(12).fill(''),\n  memo: '',\n  count: 0\n}, {\n  id: 3,\n  no: 3,\n  employee_id: '3333',\n  name: '佐藤 一郎',\n  disability_type: '知的障害',\n  disability: '',\n  grade: 'B',\n  hire_date: '2020/04/01',\n  status: '在籍',\n  monthlyStatus: Array(12).fill(''),\n  memo: '',\n  count: 0\n}];\n\n// 年間データをUI用の月次詳細形式に変換する関数\nexport const formatYearlyDataForUI = yearlyData => {\n  // 無効なデータをフィルタリング\n  const validData = yearlyData.filter(d => d != null);\n\n  // 月別に並べ替え（4月始まり会計年度を想定）\n  const orderedData = [...validData.filter(d => d.month >= 4).sort((a, b) => a.month - b.month), ...validData.filter(d => d.month <= 3).sort((a, b) => a.month - b.month)];\n\n  // 各月のデータを取得、存在しない月はデフォルト値（例: 0）を設定\n  const monthsInFiscalYear = [4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3];\n  const getMonthlyValue = (data, month, key, defaultValue = 0) => {\n    const report = data.find(d => d.month === month);\n\n    // 特定のキーが法定雇用率の場合、小数点以下2桁で表示\n    if (key === 'legal_employment_rate' || key === 'employment_rate') {\n      const value = report ? safeNumber(report[key]) : defaultValue;\n      // 小数点以下2桁まで保持\n      return parseFloat(value.toFixed(2));\n    }\n    return report ? safeNumber(report[key]) : defaultValue;\n  };\n  const totalEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'employees_count'));\n  const fullTimeEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'fulltime_count'));\n  const partTimeEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'parttime_count'));\n  const level1_2CountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'level1_2_count'));\n  const otherDisabilityCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'other_disability_count'));\n  const level1_2ParttimeCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'level1_2_parttime_count'));\n  const otherParttimeCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'other_parttime_count'));\n  const totalDisabilityCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'total_disability_count'));\n  const actualRateValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'employment_rate', 0.0));\n  const legalRateValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'legal_employment_rate', 0.0));\n  const legalCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'required_count'));\n  const overUnderValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'over_under_count'));\n\n  // 各値の合計または平均を計算\n  const sumTotalEmployees = totalEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumFullTimeEmployees = fullTimeEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumPartTimeEmployees = partTimeEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumLevel1_2Count = level1_2CountValues.reduce((sum, val) => sum + val, 0);\n  const sumOtherDisabilityCount = otherDisabilityCountValues.reduce((sum, val) => sum + val, 0);\n  const sumLevel1_2ParttimeCount = level1_2ParttimeCountValues.reduce((sum, val) => sum + val, 0);\n  const sumOtherParttimeCount = otherParttimeCountValues.reduce((sum, val) => sum + val, 0);\n  const sumTotalDisabilityCount = totalDisabilityCountValues.reduce((sum, val) => sum + val, 0);\n  const avgActualRate = parseFloat((actualRateValues.reduce((sum, val) => sum + val, 0) / (orderedData.length || 1)).toFixed(2));\n  const avgLegalRate = parseFloat((legalRateValues.reduce((sum, val) => sum + val, 0) / (orderedData.length || 1)).toFixed(2));\n  const sumLegalCount = legalCountValues.reduce((sum, val) => sum + val, 0);\n  const sumOverUnder = overUnderValues.reduce((sum, val) => sum + val, 0);\n\n  // UI表示用のデータ形式に変換\n  return {\n    months: ['4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月', '1月', '2月', '3月', '合計'],\n    data: [{\n      id: 1,\n      item: '従業員数',\n      values: [...totalEmployeesValues, sumTotalEmployees],\n      suffix: '名'\n    }, {\n      id: 2,\n      item: 'フルタイム従業員数',\n      values: [...fullTimeEmployeesValues, sumFullTimeEmployees],\n      suffix: '名'\n    }, {\n      id: 3,\n      item: 'パートタイム従業員数',\n      values: [...partTimeEmployeesValues, sumPartTimeEmployees],\n      suffix: '名'\n    }, {\n      id: 4,\n      item: 'トータル従業員数',\n      values: [...totalEmployeesValues.map((v, i) => v + partTimeEmployeesValues[i] * 0.5), sumTotalEmployees + sumPartTimeEmployees * 0.5],\n      suffix: '名',\n      isCalculated: true\n    }, {\n      id: 5,\n      item: '1級・2級の障がい者',\n      values: [...level1_2CountValues, sumLevel1_2Count],\n      suffix: '名',\n      isDisability: true\n    }, {\n      id: 6,\n      item: 'その他障がい者',\n      values: [...otherDisabilityCountValues, sumOtherDisabilityCount],\n      suffix: '名',\n      isDisability: true\n    }, {\n      id: 7,\n      item: '1級・2級の障がい者(パートタイム)',\n      values: [...level1_2ParttimeCountValues, sumLevel1_2ParttimeCount],\n      suffix: '名',\n      isDisability: true\n    }, {\n      id: 8,\n      item: 'その他障がい者(パートタイム)',\n      values: [...otherParttimeCountValues, sumOtherParttimeCount],\n      suffix: '名',\n      isDisability: true\n    }, {\n      id: 9,\n      item: '障がい者合計',\n      values: [...totalDisabilityCountValues, sumTotalDisabilityCount],\n      suffix: '名',\n      isDisability: true,\n      isCalculated: true\n    }, {\n      id: 10,\n      item: '実雇用率',\n      values: [...actualRateValues, avgActualRate],\n      suffix: '%',\n      isRatio: true,\n      isCalculated: true\n    }, {\n      id: 11,\n      item: '法定雇用率',\n      values: [...legalRateValues, avgLegalRate],\n      suffix: '%',\n      isRatio: true\n    }, {\n      id: 12,\n      item: '法定雇用者数',\n      values: [...legalCountValues, sumLegalCount],\n      suffix: '名',\n      isCalculated: true\n    }, {\n      id: 13,\n      item: '超過・未達',\n      values: [...overUnderValues, sumOverUnder],\n      isNegative: true,\n      isCalculated: true,\n      suffix: '名'\n    }]\n  };\n};\n\n// デフォルトの月次レポートを作成する関数\nconst createDefaultMonthlyReport = async (year, month) => {\n  try {\n    const defaultData = {\n      fiscal_year: year,\n      month: month,\n      employees_count: 0,\n      fulltime_count: 0,\n      parttime_count: 0,\n      level1_2_count: 0,\n      other_disability_count: 0,\n      level1_2_parttime_count: 0,\n      other_parttime_count: 0,\n      legal_employment_rate: 2.3 // デフォルト値\n    };\n    console.log(`${year}年度${month}月のデータを新規作成します`);\n    const response = await createMonthlyReport(year, month, defaultData);\n    console.log(`${year}年度${month}月のデータを新規作成しました:`, response);\n    return response;\n  } catch (error) {\n    console.error('新規レポート作成エラー:', error);\n    throw error;\n  }\n};\n\n// 指定した年月のレポートが存在するかチェックする関数\nconst checkReportExists = async (year, month) => {\n  try {\n    // apiClient または enhancedClient を使用（直接axiosを使用しない）\n    // APIベースURLはプロキシ設定と一致させるため、ここでは相対パスを使用\n    console.log(`存在チェック: /api/monthly-reports/${year}/${month}`);\n    const response = await axios.get(`/api/monthly-reports/${year}/${month}`);\n    return !!response.data && !!response.data.success;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      var _error$response, _error$request;\n      // 404エラーの場合はレポートが存在しないと判断\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 404) {\n        return false;\n      }\n\n      // HTMLレスポンスが返された場合（JSONパースエラーの原因）\n      const responseText = (_error$request = error.request) === null || _error$request === void 0 ? void 0 : _error$request.responseText;\n      if (responseText && typeof responseText === 'string' && (responseText.includes('<!DOCTYPE') || responseText.includes('<html'))) {\n        var _error$config;\n        console.error('HTML応答を検出:', (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url);\n        return false;\n      }\n    }\n    console.error('データ存在チェックエラー:', error);\n    return false;\n  }\n};\n\n// MonthlyReport コンポーネント\nconst MonthlyReport = () => {\n  _s2();\n  var _s = $RefreshSig$();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const queryParams = new URLSearchParams(location.search);\n  const queryClient = useQueryClient();\n  const tabFromUrl = queryParams.get('tab') || 'summary';\n\n  // 現在のタブ状態\n  const [activeTab, setActiveTab] = useState(tabFromUrl);\n\n  // 現在の日付から正しい年度と月を取得\n  const currentDate = new Date();\n  const currentMonthNumber = currentDate.getMonth() + 1; // JavaScriptは0から始まる\n\n  // 年月の初期値を設定\n  const initialYear = currentDate.getFullYear();\n  const initialMonth = currentMonthNumber;\n\n  // エラーメッセージ状態\n  const [errorMessage, setErrorMessage] = useState(null);\n  // 成功メッセージ状態\n  const [successMessage, setSuccessMessage] = useState(null);\n  // 新規作成フラグ\n  const [isCreatingNewReport, setIsCreatingNewReport] = useState(false);\n\n  // データがキャッシュから使用されているかどうかのフラグ\n  const [isUsingCachedData, setIsUsingCachedData] = useState(false);\n\n  // 年度ごとのデータキャッシュ\n  const [dataCache, setDataCache] = useState({});\n\n  // データ状態\n  const [currentReport, setCurrentReport] = useState({\n    summary: null,\n    employees: [],\n    detail: null\n  });\n\n  // タブ変更時のURL更新\n  useEffect(() => {\n    // URLのクエリパラメータを更新\n    navigate(`/monthly-report?tab=${activeTab}`, {\n      replace: true\n    });\n  }, [activeTab, navigate]);\n\n  // MonthlyReportContent コンポーネント - YearMonthContextを使用\n  const MonthlyReportContent = () => {\n    _s();\n    const {\n      fiscalYear,\n      month,\n      setFiscalYear,\n      setMonth,\n      dispatchYearMonthChange\n    } = useYearMonth();\n\n    // React Query - レポート一覧\n    const {\n      data: reportsList,\n      isLoading: isLoadingReportsList,\n      error: reportsListError\n    } = useQuery(['monthlyReports'], () => getMonthlyReports(), {\n      onSuccess: data => {\n        // 最新のレポートを取得\n        if (data && data.length > 0) {\n          const latestReport = data[0];\n          // 最新レポートの詳細を取得\n          queryClient.invalidateQueries(['monthlyReport', latestReport.fiscal_year, latestReport.month]);\n        }\n      },\n      staleTime: 5 * 60 * 1000,\n      // 5分間はStaleとみなさない\n      cacheTime: 10 * 60 * 1000 // 10分間キャッシュを保持\n    });\n\n    // React Query - 月次レポート取得\n    const {\n      data: reportData,\n      isLoading: isLoadingReportData,\n      error: reportDataError,\n      refetch: refetchReportData\n    } = useQuery(['monthlyReport', fiscalYear, month], async () => {\n      // 年月が有効値であることを確認\n      const validYear = fiscalYear || initialYear;\n      const validMonth = month || initialMonth;\n      console.log(`年度${validYear}、月${validMonth}のデータ取得開始`);\n      try {\n        // キャッシュキーを生成\n        const cacheKey = `${validYear}-${validMonth}`;\n\n        // まず、キャッシュに既にデータがあるか確認\n        if (dataCache[cacheKey] && !isUsingCachedData) {\n          console.log(`${validYear}年${validMonth}月のキャッシュデータを使用します`);\n          setIsUsingCachedData(true);\n          return dataCache[cacheKey];\n        }\n\n        // データ取得\n        const data = await getMonthlyReport(validYear, validMonth);\n        console.log('API応答:', data);\n\n        // キャッシュを更新\n        setDataCache(prev => ({\n          ...prev,\n          [cacheKey]: data\n        }));\n        setIsUsingCachedData(false);\n        return data;\n      } catch (error) {\n        var _error$response2;\n        // 404エラーの場合は新規作成モードに切り替え\n        if (axios.isAxiosError(error) && ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 404) {\n          console.log(`${validYear}年${validMonth}月のデータが存在しません。新規作成モードに切替`);\n          setIsCreatingNewReport(true);\n\n          // デフォルトの空データを自動生成\n          try {\n            await createDefaultMonthlyReport(validYear, validMonth);\n            // 再度データを取得\n            return await getMonthlyReport(validYear, validMonth);\n          } catch (createError) {\n            console.error('デフォルトデータの作成に失敗しました:', createError);\n            // 空のデータを返す\n            return {\n              success: true,\n              message: 'デフォルトデータを表示',\n              data: {\n                summary: null,\n                employees: [],\n                detail: null\n              }\n            };\n          }\n        }\n\n        // その他のエラーは再スロー\n        throw error;\n      }\n    }, {\n      onSuccess: data => {\n        // 新規作成モードの場合はリセット\n        if (isCreatingNewReport && data && data.success) {\n          setIsCreatingNewReport(false);\n        }\n        if (data) {\n          var _data$data, _data$data2, _data$data3;\n          // サマリーデータの安全な処理\n          const summaryData = ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.summary) || null;\n          let detailData = ((_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.detail) || null;\n\n          // サマリーデータが存在する場合のみformatYearlyDataForUIを呼び出す\n          if (summaryData && !detailData) {\n            try {\n              detailData = formatYearlyDataForUI([summaryData]);\n            } catch (error) {\n              console.error(\"詳細データの生成中にエラーが発生しました:\", error);\n              detailData = null;\n            }\n          }\n\n          // 従業員データが空の場合はサンプルデータを使用\n          const employeesData = data !== null && data !== void 0 && (_data$data3 = data.data) !== null && _data$data3 !== void 0 && _data$data3.employees && data.data.employees.length > 0 ? data.data.employees : sampleEmployees;\n          setCurrentReport({\n            summary: summaryData,\n            employees: employeesData,\n            detail: detailData\n          });\n        } else {\n          // データがない場合はサンプルデータを使用\n          setCurrentReport({\n            summary: null,\n            employees: sampleEmployees,\n            detail: null\n          });\n        }\n      },\n      onError: error => {\n        console.error(\"月次レポートデータ取得エラー:\", error);\n        setErrorMessage('データの取得中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n\n        // エラー時はサンプルデータを表示\n        setCurrentReport(prev => ({\n          ...prev,\n          employees: sampleEmployees\n        }));\n      },\n      enabled: !!fiscalYear && !!month,\n      // 年月が設定されている場合のみクエリを実行\n      staleTime: 5 * 60 * 1000,\n      cacheTime: 10 * 60 * 1000,\n      retry: (failureCount, error) => {\n        var _error$response3;\n        // 404エラーの場合はリトライしない（存在しないデータ）\n        if (axios.isAxiosError(error) && ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 404) {\n          return false;\n        }\n        // その他のエラーは3回までリトライ\n        return failureCount < 3;\n      }\n    });\n\n    // サマリーデータ更新ハンドラー\n    const handleSummaryChange = updatedSummary => {\n      setCurrentReport(prev => ({\n        ...prev,\n        summary: updatedSummary\n      }));\n    };\n\n    // 従業員データ更新ハンドラー\n    const handleEmployeeChange = (id, field, value) => {\n      setCurrentReport(prev => {\n        if (!prev.employees) return prev;\n        return {\n          ...prev,\n          employees: prev.employees.map(emp => emp.id === id ? {\n            ...emp,\n            [field]: field === 'monthlyStatus' ? typeof value === 'string' ? JSON.parse(value) : value : value\n          } : emp)\n        };\n      });\n    };\n\n    // 月次詳細更新ハンドラー\n    const handleDetailCellChange = (rowId, colIndex, value) => {\n      setCurrentReport(prev => {\n        if (!prev.detail) return prev;\n        const newDetail = {\n          ...prev.detail\n        };\n        const rowIndex = newDetail.data.findIndex(row => row.id === rowId);\n        if (rowIndex !== -1 && colIndex < 12) {\n          // 法定雇用率フィールドの特別処理\n          const isLegalRateField = rowId === 11;\n          let numValue;\n          if (isLegalRateField) {\n            // 小数点を含む値の処理\n            if (value === '' || value === '.') {\n              numValue = 0;\n            } else if (value.endsWith('.')) {\n              numValue = parseFloat(value + '0');\n            } else {\n              numValue = parseFloat(value);\n            }\n          } else {\n            // 通常の数値変換\n            numValue = value === '' ? 0 : Number(value);\n          }\n          if (!isNaN(numValue)) {\n            const updatedValues = [...newDetail.data[rowIndex].values];\n            updatedValues[colIndex] = numValue;\n\n            // 合計の再計算\n            updatedValues[12] = updatedValues.slice(0, 12).reduce((a, b) => a + b, 0);\n            newDetail.data[rowIndex].values = updatedValues;\n          }\n        }\n        return {\n          ...prev,\n          detail: newDetail\n        };\n      });\n    };\n\n    // データ再取得ハンドラー\n    const handleRefreshData = useCallback(() => {\n      // 現在の年月のキャッシュのみをクリア\n      const cacheKey = `${fiscalYear}-${month}`;\n      setDataCache(prev => {\n        const newCache = {\n          ...prev\n        };\n        delete newCache[cacheKey];\n        return newCache;\n      });\n      setIsUsingCachedData(false);\n\n      // キャッシュを強制的に無効化\n      queryClient.invalidateQueries(['monthlyReport', fiscalYear, month]);\n\n      // データを明示的に再取得\n      refetchReportData().catch(error => {\n        console.error('データ再取得エラー:', error);\n        setErrorMessage('データの再取得中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      });\n    }, [fiscalYear, month, queryClient, refetchReportData]);\n\n    // 年度変更ハンドラー\n    const handleYearChange = async year => {\n      console.log(`親コンポーネントで年度変更を検知: ${fiscalYear} → ${year}`);\n      try {\n        // 無効な年度チェック\n        if (isNaN(year) || year <= 0) {\n          console.error('無効な年度が指定されました:', year);\n          setErrorMessage('無効な年度が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n\n        // 指定した年度のデータが存在するかチェック\n        const exists = await checkReportExists(year, month);\n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${year}年度${month}月のデータが存在しないため、新規作成します`);\n\n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(year, month);\n            console.log(`${year}年度${month}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラーを無視して続行\n          }\n        }\n\n        // YearMonthContextの年度を更新\n        setFiscalYear(year);\n\n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${year}-${month}`;\n        setDataCache(prev => {\n          const newCache = {\n            ...prev\n          };\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        setIsUsingCachedData(false);\n\n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', year, month]);\n      } catch (error) {\n        console.error('年度変更処理中にエラーが発生しました:', error);\n\n        // エラーメッセージを表示\n        setErrorMessage('年度切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // 月変更ハンドラー\n    const handleMonthChange = async newMonth => {\n      console.log(`月変更を検知: ${month} → ${newMonth}`);\n      try {\n        // 無効な月チェック\n        if (isNaN(newMonth) || newMonth < 1 || newMonth > 12) {\n          console.error('無効な月が指定されました:', newMonth);\n          setErrorMessage('無効な月が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n\n        // 現在のステートを保存\n        const prevMonth = month;\n\n        // 先にUIを更新して即時フィードバックを提供\n        setMonth(newMonth);\n\n        // 指定した年月のデータが存在するかチェック\n        const exists = await checkReportExists(fiscalYear, newMonth);\n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${fiscalYear}年度${newMonth}月のデータが存在しないため、新規作成します`);\n\n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(fiscalYear, newMonth);\n            console.log(`${fiscalYear}年度${newMonth}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラー時はUIに通知するが、ステートは既に更新済み\n            setErrorMessage('新しい月のレポート作成中にエラーが発生しました。');\n            setTimeout(() => setErrorMessage(null), 5000);\n          }\n        }\n\n        // イベント発火 - 年月の同時変更を通知\n        const yearMonthChangeEvent = new CustomEvent('yearMonthChanged', {\n          detail: {\n            year: fiscalYear,\n            month: newMonth\n          }\n        });\n        window.dispatchEvent(yearMonthChangeEvent);\n\n        // YearMonthContextの値を更新\n        dispatchYearMonthChange(fiscalYear, newMonth);\n\n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${fiscalYear}-${newMonth}`;\n        setDataCache(prev => {\n          const newCache = {\n            ...prev\n          };\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        setIsUsingCachedData(false);\n\n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', fiscalYear, newMonth]);\n\n        // 成功メッセージを表示\n        setSuccessMessage(`${fiscalYear}年${newMonth}月のデータを表示しています`);\n        setTimeout(() => setSuccessMessage(null), 3000);\n      } catch (error) {\n        console.error('月変更処理中にエラーが発生しました:', error);\n\n        // エラーメッセージを表示\n        setErrorMessage('月の切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // 年月の同時変更ハンドラー\n    const handleYearMonthChange = async (year, newMonth) => {\n      console.log(`年月変更を検知: ${fiscalYear}年${month}月 → ${year}年${newMonth}月`);\n      try {\n        // 無効な年月チェック\n        if (isNaN(year) || year <= 0) {\n          console.error('無効な年度が指定されました:', year);\n          setErrorMessage('無効な年度が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n        if (isNaN(newMonth) || newMonth < 1 || newMonth > 12) {\n          console.error('無効な月が指定されました:', newMonth);\n          setErrorMessage('無効な月が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n\n        // 指定した年月のデータが存在するかチェック\n        const exists = await checkReportExists(year, newMonth);\n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${year}年度${newMonth}月のデータが存在しないため、新規作成します`);\n\n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(year, newMonth);\n            console.log(`${year}年度${newMonth}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラーを無視して続行\n          }\n        }\n\n        // YearMonthContextの年度と月を同時に更新\n        dispatchYearMonthChange(year, newMonth);\n\n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${year}-${newMonth}`;\n        setDataCache(prev => {\n          const newCache = {\n            ...prev\n          };\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        setIsUsingCachedData(false);\n\n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', year, newMonth]);\n      } catch (error) {\n        console.error('年月変更処理中にエラーが発生しました:', error);\n\n        // エラーメッセージを表示\n        setErrorMessage('年月の切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // タブ切り替えハンドラー\n    const handleTabChange = tab => {\n      setActiveTab(tab);\n      const params = new URLSearchParams(location.search);\n      params.set('tab', tab);\n      navigate(`${location.pathname}?${params.toString()}`, {\n        replace: true\n      });\n    };\n\n    // ローディングまたはエラー状態の処理\n    const isLoading = isLoadingReportsList || isLoadingReportData;\n    const hasError = reportsListError || reportDataError;\n    if (isLoading && !currentReport.summary && !currentReport.employees.length) {\n      return /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 712,\n        columnNumber: 14\n      }, this);\n    }\n    if (hasError && !currentReport.employees.length) {\n      console.error(\"データ取得エラー:\", {\n        reportsListError,\n        reportDataError\n      });\n      return /*#__PURE__*/_jsxDEV(ErrorMessage, {\n        message: \"\\u30C7\\u30FC\\u30BF\\u306E\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D\\u306B\\u30A8\\u30E9\\u30FC\\u304C\\u767A\\u751F\\u3057\\u307E\\u3057\\u305F\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 717,\n        columnNumber: 14\n      }, this);\n    }\n    const {\n      summary,\n      employees,\n      detail\n    } = currentReport;\n    const isConfirmed = (summary === null || summary === void 0 ? void 0 : summary.status) === '確定済';\n\n    // タブ定義\n    const tabItems = [{\n      id: 'summary',\n      label: 'サマリー'\n    }, {\n      id: 'employees',\n      label: '従業員詳細'\n    }, {\n      id: 'monthly',\n      label: '月次詳細'\n    }];\n\n    // デフォルトのMonthlyTotal型オブジェクト\n    const defaultSummary = {\n      fiscal_year: fiscalYear,\n      month: month,\n      employees_count: 0,\n      fulltime_count: 0,\n      parttime_count: 0,\n      level1_2_count: 0,\n      other_disability_count: 0,\n      level1_2_parttime_count: 0,\n      other_parttime_count: 0,\n      legal_employment_rate: 2.3,\n      total_disability_count: 0,\n      employment_rate: 0,\n      required_count: 0,\n      over_under_count: 0,\n      status: '未確定'\n    };\n\n    // 月選択用オプション\n    const monthOptions = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\n    // タブコンテンツをレンダリングするための関数\n    const renderTabContent = () => {\n      console.log('タブレンダリング:', {\n        activeTab,\n        employeesCount: (employees === null || employees === void 0 ? void 0 : employees.length) || 0,\n        hasSummary: !!summary\n      });\n      if (activeTab === 'summary') {\n        return /*#__PURE__*/_jsxDEV(SummaryTab, {\n          summaryData: summary,\n          onSummaryChange: handleSummaryChange,\n          onRefreshData: handleRefreshData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 11\n        }, this);\n      }\n      if (activeTab === 'employees') {\n        return /*#__PURE__*/_jsxDEV(EmployeesTab, {\n          employees: (employees || []).map(emp => ({\n            ...emp,\n            id: emp.id,\n            employee_id: emp.employee_id !== undefined ? String(emp.employee_id) : '',\n            // number型をstring型に変換\n            disability_type: emp.disability_type || '',\n            // undefinedの場合は空文字列に変換\n            disability: emp.disability || '',\n            // 念のため\n            grade: emp.grade || '',\n            // 念のため\n            name: emp.name || '',\n            // 念のため\n            status: emp.status || '在籍',\n            // 念のため\n            hire_date: emp.hire_date || new Date().toISOString().split('T')[0].replace(/-/g, '/') // 念のため\n          })),\n          onEmployeeChange: handleEmployeeChange,\n          onEmployeesUpdate: updatedEmployees => {\n            console.log('子コンポーネントから従業員データ更新を受信:', updatedEmployees.length, '件');\n            // 型互換性のために必要なプロパティを追加\n            const typeCompatibleEmployees = updatedEmployees.map(emp => ({\n              ...emp,\n              no: emp.no || 0 // noが未定義の場合は0を設定して型互換性を確保\n            }));\n\n            // イベントオブジェクトを生成して状態の同期を管理（デバッグ用識別値を追加）\n            const uniqueId = new Date().getTime();\n            console.log(`[${uniqueId}] 親コンポーネントで状態更新開始`);\n\n            // 非同期で状態更新を行い、無限ループを防ぐ\n            setTimeout(() => {\n              console.log(`[${uniqueId}] 親コンポーネントで状態更新実行`);\n              setCurrentReport(prev => {\n                // 前の状態と新しい状態が実質的に同じ場合は更新しない\n                if (JSON.stringify(prev.employees.map(e => e.id)) === JSON.stringify(typeCompatibleEmployees.map(e => e.id)) && prev.employees.length === typeCompatibleEmployees.length) {\n                  console.log(`[${uniqueId}] 従業員データに変更がないため、状態更新をスキップ`);\n                  return prev;\n                }\n                console.log(`[${uniqueId}] 従業員データを更新:`, typeCompatibleEmployees.length, '件');\n                return {\n                  ...prev,\n                  employees: typeCompatibleEmployees\n                };\n              });\n            }, 100); // 100ms遅延で実行\n          },\n          summaryData: summary || defaultSummary,\n          onRefreshData: handleRefreshData,\n          onYearChange: handleYearChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 772,\n          columnNumber: 11\n        }, this);\n      }\n      if (activeTab === 'monthly') {\n        return /*#__PURE__*/_jsxDEV(MonthlyReportDetail, {\n          isEmbedded: true,\n          summaryData: summary || undefined,\n          monthlyDetailData: detail || undefined,\n          onDetailCellChange: handleDetailCellChange,\n          onYearChange: handleYearChange,\n          onRefreshData: handleRefreshData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 826,\n          columnNumber: 11\n        }, this);\n      }\n\n      // データがない場合、各タブで新規作成UIを表示するためにnullを返す\n      return null;\n    };\n\n    // 条件付きレンダリング要素を事前に作成\n    const errorMessageElement = errorMessage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      style: {\n        backgroundColor: '#f8d7da',\n        color: '#721c24',\n        padding: '10px',\n        borderRadius: '4px',\n        marginBottom: '15px'\n      },\n      children: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 843,\n      columnNumber: 7\n    }, this) : null;\n    const successMessageElement = successMessage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-message\",\n      style: {\n        backgroundColor: '#d4edda',\n        color: '#155724',\n        padding: '10px',\n        borderRadius: '4px',\n        marginBottom: '15px'\n      },\n      children: successMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 855,\n      columnNumber: 7\n    }, this) : null;\n    const hasErrorElement = hasError ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#f8d7da',\n        color: '#721c24',\n        padding: '10px',\n        borderRadius: '4px',\n        marginBottom: '15px'\n      },\n      children: \"\\u30C7\\u30FC\\u30BF\\u306E\\u53D6\\u5F97\\u4E2D\\u306B\\u30A8\\u30E9\\u30FC\\u304C\\u767A\\u751F\\u3057\\u307E\\u3057\\u305F\\u3002\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 867,\n      columnNumber: 7\n    }, this) : null;\n    const isLoadingElement = isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#e9ecef',\n        padding: '10px',\n        borderRadius: '4px',\n        marginBottom: '15px',\n        textAlign: 'center'\n      },\n      children: \"\\u30C7\\u30FC\\u30BF\\u3092\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 879,\n      columnNumber: 7\n    }, this) : null;\n\n    // サマリー表示要素（タブがサマリーの場合のみ表示）\n    const summaryElement = summary && activeTab === 'summary' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#e9f2ff',\n        padding: '15px 20px',\n        borderRadius: '8px',\n        marginBottom: '20px',\n        borderLeft: '4px solid #3a66d4',\n        fontSize: '0.9rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          fontSize: '1.1rem',\n          margin: '0 0 10px 0',\n          color: '#3a66d4'\n        },\n        children: [summary.fiscal_year, \"\\u5E74 \", summary.month, \"\\u6708 \\u30B5\\u30DE\\u30EA\\u30FC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 900,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: '10px 20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u5E38\\u7528\\u52B4\\u50CD\\u8005\\u6570: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: summary.employees_count\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 904,\n            columnNumber: 25\n          }, this), \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 904,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 905,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u3046\\u3061\\u30D5\\u30EB\\u30BF\\u30A4\\u30E0: \", summary.fulltime_count, \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 906,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 907,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u3046\\u3061\\u30D1\\u30FC\\u30C8\\u30BF\\u30A4\\u30E0: \", summary.parttime_count, \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 908,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 909,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u969C\\u5BB3\\u8005\\u6570 (\\u30AB\\u30A6\\u30F3\\u30C8): \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: safeNumber(summary.total_disability_count).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 910,\n            columnNumber: 30\n          }, this), \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 910,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 911,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u5B9F\\u96C7\\u7528\\u7387: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: safeNumber(summary.employment_rate).toFixed(2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 912,\n            columnNumber: 23\n          }, this), \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 912,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 913,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u6CD5\\u5B9A\\u96C7\\u7528\\u7387: \", safeNumber(summary.legal_employment_rate).toFixed(2), \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 914,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 915,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u6CD5\\u5B9A\\u96C7\\u7528\\u969C\\u5BB3\\u8005\\u6570: \", safeNumber(summary.required_count).toFixed(1), \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 916,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 917,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u4E0D\\u8DB3\\u6570: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            style: {\n              color: safeNumber(summary.over_under_count) < 0 ? 'red' : 'inherit'\n            },\n            children: safeNumber(summary.over_under_count).toFixed(1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 918,\n            columnNumber: 22\n          }, this), \"\\u540D\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 918,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 903,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 892,\n      columnNumber: 7\n    }, this) : null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"monthly-report-container\",\n      style: {\n        padding: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          marginBottom: '20px'\n        },\n        children: \"\\u6708\\u6B21\\u5831\\u544A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 925,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '20px',\n          marginBottom: '20px',\n          backgroundColor: '#f8f9fa',\n          padding: '10px 15px',\n          borderRadius: '4px',\n          border: '1px solid #ddd'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              marginRight: '8px',\n              fontSize: '0.9rem'\n            },\n            children: \"\\u5E74\\u5EA6:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 938,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: fiscalYear,\n            onChange: e => handleYearChange(parseInt(e.target.value, 10)),\n            style: {\n              padding: '6px 10px',\n              borderRadius: '4px',\n              border: '1px solid #ced4da',\n              fontSize: '0.9rem'\n            },\n            children: Array.from({\n              length: 11\n            }, (_, i) => currentDate.getFullYear() - 5 + i).map(year => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: year,\n              children: year\n            }, year, false, {\n              fileName: _jsxFileName,\n              lineNumber: 950,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 939,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 937,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              marginRight: '8px',\n              fontSize: '0.9rem'\n            },\n            children: \"\\u6708:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 956,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: month,\n            onChange: e => handleMonthChange(parseInt(e.target.value, 10)),\n            style: {\n              padding: '6px 10px',\n              borderRadius: '4px',\n              border: '1px solid #ced4da',\n              fontSize: '0.9rem'\n            },\n            children: monthOptions.map(m => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: m,\n              children: [m, \"\\u6708\"]\n            }, m, true, {\n              fileName: _jsxFileName,\n              lineNumber: 968,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 957,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 955,\n          columnNumber: 11\n        }, this), process.env.NODE_ENV === 'development' && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: 'auto',\n            fontSize: '0.8rem',\n            color: '#666'\n          },\n          children: [\"\\u5E74\\u5EA6: \", fiscalYear, \", \\u6708: \", month]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 975,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleRefreshData,\n          style: {\n            padding: '6px 12px',\n            backgroundColor: '#007bff',\n            color: 'white',\n            border: 'none',\n            borderRadius: '4px',\n            cursor: 'pointer'\n          },\n          disabled: isLoading,\n          children: \"\\u66F4\\u65B0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 980,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 928,\n        columnNumber: 9\n      }, this), errorMessageElement, successMessageElement, hasErrorElement, isLoadingElement, summaryElement, /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          borderBottom: '1px solid #ddd',\n          marginBottom: '20px'\n        },\n        children: tabItems.map(tab => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleTabChange(tab.id),\n          style: {\n            padding: '10px 20px',\n            background: 'none',\n            border: 'none',\n            borderBottom: activeTab === tab.id ? '3px solid #007bff' : '3px solid transparent',\n            marginBottom: '-1px',\n            color: activeTab === tab.id ? '#007bff' : '#666',\n            fontWeight: activeTab === tab.id ? 'bold' : 'normal',\n            cursor: 'pointer',\n            transition: 'color 0.2s, border-bottom-color 0.2s',\n            fontSize: '1rem'\n          },\n          children: tab.label\n        }, tab.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1009,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1003,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-content\",\n        children: renderTabContent()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1030,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 924,\n      columnNumber: 7\n    }, this);\n  };\n\n  // メインコンポーネントのレンダリング\n  _s(MonthlyReportContent, \"6g099D1Wn8C/1xR0cXgbbMpThrg=\", false, function () {\n    return [useYearMonth, useQuery, useQuery];\n  });\n  return /*#__PURE__*/_jsxDEV(YearMonthProvider, {\n    initialYear: initialYear,\n    initialMonth: initialMonth,\n    children: /*#__PURE__*/_jsxDEV(MonthlyReportContent, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1040,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1039,\n    columnNumber: 5\n  }, this);\n};\n_s2(MonthlyReport, \"5+Qbb5D7QI+2dJRxO8k4m52SAlc=\", false, function () {\n  return [useNavigate, useLocation, useQueryClient];\n});\n_c = MonthlyReport;\nexport default MonthlyReport;\nvar _c;\n$RefreshReg$(_c, \"MonthlyReport\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","useLocation","useQuery","useQueryClient","SummaryTab","EmployeesTab","MonthlyReportDetail","YearMonthProvider","useYearMonth","getMonthlyReport","getMonthlyReports","createMonthlyReport","safeNumber","Spinner","ErrorMessage","axios","jsxDEV","_jsxDEV","API_BASE_URL","process","env","NODE_ENV","REACT_APP_API_URL","sampleEmployees","id","no","employee_id","name","disability_type","disability","grade","hire_date","status","monthlyStatus","Array","fill","memo","count","formatYearlyDataForUI","yearlyData","validData","filter","d","orderedData","month","sort","a","b","monthsInFiscalYear","getMonthlyValue","data","key","defaultValue","report","find","value","parseFloat","toFixed","totalEmployeesValues","map","m","fullTimeEmployeesValues","partTimeEmployeesValues","level1_2CountValues","otherDisabilityCountValues","level1_2ParttimeCountValues","otherParttimeCountValues","totalDisabilityCountValues","actualRateValues","legalRateValues","legalCountValues","overUnderValues","sumTotalEmployees","reduce","sum","val","sumFullTimeEmployees","sumPartTimeEmployees","sumLevel1_2Count","sumOtherDisabilityCount","sumLevel1_2ParttimeCount","sumOtherParttimeCount","sumTotalDisabilityCount","avgActualRate","length","avgLegalRate","sumLegalCount","sumOverUnder","months","item","values","suffix","v","i","isCalculated","isDisability","isRatio","isNegative","createDefaultMonthlyReport","year","defaultData","fiscal_year","employees_count","fulltime_count","parttime_count","level1_2_count","other_disability_count","level1_2_parttime_count","other_parttime_count","legal_employment_rate","console","log","response","error","checkReportExists","get","success","isAxiosError","_error$response","_error$request","responseText","request","includes","_error$config","config","url","MonthlyReport","_s2","_s","$RefreshSig$","navigate","location","queryParams","URLSearchParams","search","queryClient","tabFromUrl","activeTab","setActiveTab","currentDate","Date","currentMonthNumber","getMonth","initialYear","getFullYear","initialMonth","errorMessage","setErrorMessage","successMessage","setSuccessMessage","isCreatingNewReport","setIsCreatingNewReport","isUsingCachedData","setIsUsingCachedData","dataCache","setDataCache","currentReport","setCurrentReport","summary","employees","detail","replace","MonthlyReportContent","fiscalYear","setFiscalYear","setMonth","dispatchYearMonthChange","reportsList","isLoading","isLoadingReportsList","reportsListError","onSuccess","latestReport","invalidateQueries","staleTime","cacheTime","reportData","isLoadingReportData","reportDataError","refetch","refetchReportData","validYear","validMonth","cacheKey","prev","_error$response2","createError","message","_data$data","_data$data2","_data$data3","summaryData","detailData","employeesData","onError","setTimeout","enabled","retry","failureCount","_error$response3","handleSummaryChange","updatedSummary","handleEmployeeChange","field","emp","JSON","parse","handleDetailCellChange","rowId","colIndex","newDetail","rowIndex","findIndex","row","isLegalRateField","numValue","endsWith","Number","isNaN","updatedValues","slice","handleRefreshData","newCache","catch","handleYearChange","exists","handleMonthChange","newMonth","prevMonth","yearMonthChangeEvent","CustomEvent","window","dispatchEvent","handleYearMonthChange","handleTabChange","tab","params","set","pathname","toString","hasError","fileName","_jsxFileName","lineNumber","columnNumber","isConfirmed","tabItems","label","defaultSummary","total_disability_count","employment_rate","required_count","over_under_count","monthOptions","renderTabContent","employeesCount","hasSummary","onSummaryChange","onRefreshData","undefined","String","toISOString","split","onEmployeeChange","onEmployeesUpdate","updatedEmployees","typeCompatibleEmployees","uniqueId","getTime","stringify","e","onYearChange","isEmbedded","monthlyDetailData","onDetailCellChange","errorMessageElement","className","style","backgroundColor","color","padding","borderRadius","marginBottom","children","successMessageElement","hasErrorElement","isLoadingElement","textAlign","summaryElement","borderLeft","fontSize","margin","display","flexWrap","gap","border","marginRight","onChange","parseInt","target","from","_","marginLeft","onClick","cursor","disabled","borderBottom","background","fontWeight","transition","_c","$RefreshReg$"],"sources":["/Users/gotouhiroaki/Programming/DAN_work/disability-employment-system/frontend/src/pages/MonthlyReport/index.tsx"],"sourcesContent":["// src/pages/MonthlyReport/index.tsx\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useQuery, useQueryClient } from 'react-query';\nimport SummaryTab from './SummaryTab';\nimport EmployeesTab from './EmployeesTab';\nimport MonthlyReportDetail from './MonthlyReportDetail';\nimport { MonthlyTotal, Employee, MonthlyDetailData } from './types';\nimport { YearMonthProvider, useYearMonth } from './YearMonthContext';\nimport { \n  getMonthlyReport, \n  getMonthlyReports, \n  handleApiError,\n  createMonthlyReport\n} from '../../api/reportApi';\nimport { safeNumber, processEmployeeData } from './utils';\nimport Spinner from '../../components/common/Spinner';\nimport ErrorMessage from '../../components/common/ErrorMessage';\nimport axios from 'axios';\nimport CSVImportModal from './CSVImportModal';\nimport { generateCSVTemplate, downloadCSV } from './utils';\nimport '../UIFixer.js'; // 従業員詳細と月次報告画面の年度表示最適化\n\n// API base URL \n// 開発環境ではproxy設定を使用するため、'/api'とする\nconst API_BASE_URL = process.env.NODE_ENV === 'development' \n  ? '/api' \n  : (process.env.REACT_APP_API_URL || 'http://localhost:5001/api');\n\n// サンプル従業員データ（デフォルト表示用）\nconst sampleEmployees: Employee[] = [\n  {\n    id: 1,\n    no: 1,\n    employee_id: '1001',\n    name: '山田 太郎',\n    disability_type: '身体障害',\n    disability: '視覚',\n    grade: '1級',\n    hire_date: '2020/04/01',\n    status: '在籍',\n    monthlyStatus: Array(12).fill(''),\n    memo: '',\n    count: 0\n  },\n  {\n    id: 2,\n    no: 2,\n    employee_id: '2222',\n    name: '鈴木 花子',\n    disability_type: '身体障害',\n    disability: '聴覚',\n    grade: '4級',\n    hire_date: '2020/04/01',\n    status: '在籍',\n    monthlyStatus: Array(12).fill(''),\n    memo: '',\n    count: 0\n  },\n  {\n    id: 3,\n    no: 3,\n    employee_id: '3333',\n    name: '佐藤 一郎',\n    disability_type: '知的障害',\n    disability: '',\n    grade: 'B',\n    hire_date: '2020/04/01',\n    status: '在籍',\n    monthlyStatus: Array(12).fill(''),\n    memo: '',\n    count: 0\n  }\n];\n\n// 年間データをUI用の月次詳細形式に変換する関数\nexport const formatYearlyDataForUI = (yearlyData: MonthlyTotal[]): MonthlyDetailData => {\n  // 無効なデータをフィルタリング\n  const validData = yearlyData.filter(d => d != null);\n  \n  // 月別に並べ替え（4月始まり会計年度を想定）\n  const orderedData = [\n    ...validData.filter(d => d.month >= 4).sort((a, b) => a.month - b.month),\n    ...validData.filter(d => d.month <= 3).sort((a, b) => a.month - b.month)\n  ];\n\n  // 各月のデータを取得、存在しない月はデフォルト値（例: 0）を設定\n  const monthsInFiscalYear = [4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3];\n  const getMonthlyValue = (data: MonthlyTotal[], month: number, key: keyof MonthlyTotal, defaultValue: number = 0): number => {\n    const report = data.find(d => d.month === month);\n    \n    // 特定のキーが法定雇用率の場合、小数点以下2桁で表示\n    if (key === 'legal_employment_rate' || key === 'employment_rate') {\n      const value = report ? safeNumber(report[key]) : defaultValue;\n      // 小数点以下2桁まで保持\n      return parseFloat(value.toFixed(2));\n    }\n    \n    return report ? safeNumber(report[key]) : defaultValue;\n  };\n\n  const totalEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'employees_count'));\n  const fullTimeEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'fulltime_count'));\n  const partTimeEmployeesValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'parttime_count'));\n  const level1_2CountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'level1_2_count'));\n  const otherDisabilityCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'other_disability_count'));\n  const level1_2ParttimeCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'level1_2_parttime_count'));\n  const otherParttimeCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'other_parttime_count'));\n  const totalDisabilityCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'total_disability_count'));\n  const actualRateValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'employment_rate', 0.0));\n  const legalRateValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'legal_employment_rate', 0.0));\n  const legalCountValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'required_count'));\n  const overUnderValues = monthsInFiscalYear.map(m => getMonthlyValue(orderedData, m, 'over_under_count'));\n\n  // 各値の合計または平均を計算\n  const sumTotalEmployees = totalEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumFullTimeEmployees = fullTimeEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumPartTimeEmployees = partTimeEmployeesValues.reduce((sum, val) => sum + val, 0);\n  const sumLevel1_2Count = level1_2CountValues.reduce((sum, val) => sum + val, 0);\n  const sumOtherDisabilityCount = otherDisabilityCountValues.reduce((sum, val) => sum + val, 0);\n  const sumLevel1_2ParttimeCount = level1_2ParttimeCountValues.reduce((sum, val) => sum + val, 0);\n  const sumOtherParttimeCount = otherParttimeCountValues.reduce((sum, val) => sum + val, 0);\n  const sumTotalDisabilityCount = totalDisabilityCountValues.reduce((sum, val) => sum + val, 0);\n  const avgActualRate = parseFloat((actualRateValues.reduce((sum, val) => sum + val, 0) / (orderedData.length || 1)).toFixed(2));\n  const avgLegalRate = parseFloat((legalRateValues.reduce((sum, val) => sum + val, 0) / (orderedData.length || 1)).toFixed(2));\n  const sumLegalCount = legalCountValues.reduce((sum, val) => sum + val, 0);\n  const sumOverUnder = overUnderValues.reduce((sum, val) => sum + val, 0);\n\n  // UI表示用のデータ形式に変換\n  return {\n    months: ['4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月', '1月', '2月', '3月', '合計'],\n    data: [\n      { id: 1, item: '従業員数', values: [...totalEmployeesValues, sumTotalEmployees], suffix: '名' },\n      { id: 2, item: 'フルタイム従業員数', values: [...fullTimeEmployeesValues, sumFullTimeEmployees], suffix: '名' },\n      { id: 3, item: 'パートタイム従業員数', values: [...partTimeEmployeesValues, sumPartTimeEmployees], suffix: '名' },\n      { id: 4, item: 'トータル従業員数', values: [...totalEmployeesValues.map((v, i) => v + (partTimeEmployeesValues[i] * 0.5)), sumTotalEmployees + (sumPartTimeEmployees * 0.5)], suffix: '名', isCalculated: true },\n      { id: 5, item: '1級・2級の障がい者', values: [...level1_2CountValues, sumLevel1_2Count], suffix: '名', isDisability: true },\n      { id: 6, item: 'その他障がい者', values: [...otherDisabilityCountValues, sumOtherDisabilityCount], suffix: '名', isDisability: true },\n      { id: 7, item: '1級・2級の障がい者(パートタイム)', values: [...level1_2ParttimeCountValues, sumLevel1_2ParttimeCount], suffix: '名', isDisability: true },\n      { id: 8, item: 'その他障がい者(パートタイム)', values: [...otherParttimeCountValues, sumOtherParttimeCount], suffix: '名', isDisability: true },\n      { id: 9, item: '障がい者合計', values: [...totalDisabilityCountValues, sumTotalDisabilityCount], suffix: '名', isDisability: true, isCalculated: true },\n      { id: 10, item: '実雇用率', values: [...actualRateValues, avgActualRate], suffix: '%', isRatio: true, isCalculated: true },\n      { id: 11, item: '法定雇用率', values: [...legalRateValues, avgLegalRate], suffix: '%', isRatio: true },\n      { id: 12, item: '法定雇用者数', values: [...legalCountValues, sumLegalCount], suffix: '名', isCalculated: true },\n      { id: 13, item: '超過・未達', values: [...overUnderValues, sumOverUnder], isNegative: true, isCalculated: true, suffix: '名' }\n    ]\n  };\n};\n\n// デフォルトの月次レポートを作成する関数\nconst createDefaultMonthlyReport = async (year: number, month: number) => {\n  try {\n    const defaultData = {\n      fiscal_year: year,\n      month: month,\n      employees_count: 0,\n      fulltime_count: 0,\n      parttime_count: 0,\n      level1_2_count: 0,\n      other_disability_count: 0,\n      level1_2_parttime_count: 0,\n      other_parttime_count: 0,\n      legal_employment_rate: 2.3 // デフォルト値\n    };\n    \n    console.log(`${year}年度${month}月のデータを新規作成します`);\n    const response = await createMonthlyReport(year, month, defaultData);\n    console.log(`${year}年度${month}月のデータを新規作成しました:`, response);\n    return response;\n  } catch (error) {\n    console.error('新規レポート作成エラー:', error);\n    throw error;\n  }\n};\n\n// 指定した年月のレポートが存在するかチェックする関数\nconst checkReportExists = async (year: number, month: number): Promise<boolean> => {\n  try {\n    // apiClient または enhancedClient を使用（直接axiosを使用しない）\n    // APIベースURLはプロキシ設定と一致させるため、ここでは相対パスを使用\n    console.log(`存在チェック: /api/monthly-reports/${year}/${month}`);\n    const response = await axios.get(`/api/monthly-reports/${year}/${month}`);\n    return !!response.data && !!response.data.success;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      // 404エラーの場合はレポートが存在しないと判断\n      if (error.response?.status === 404) {\n        return false;\n      }\n      \n      // HTMLレスポンスが返された場合（JSONパースエラーの原因）\n      const responseText = error.request?.responseText;\n      if (responseText && typeof responseText === 'string' && \n          (responseText.includes('<!DOCTYPE') || \n           responseText.includes('<html'))) {\n        console.error('HTML応答を検出:', error.config?.url);\n        return false;\n      }\n    }\n    \n    console.error('データ存在チェックエラー:', error);\n    return false;\n  }\n};\n\n// MonthlyReport コンポーネント\nconst MonthlyReport: React.FC = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const queryParams = new URLSearchParams(location.search);\n  const queryClient = useQueryClient();\n  const tabFromUrl = queryParams.get('tab') || 'summary';\n\n  // 現在のタブ状態\n  const [activeTab, setActiveTab] = useState<string>(tabFromUrl);\n  \n  // 現在の日付から正しい年度と月を取得\n  const currentDate = new Date();\n  const currentMonthNumber = currentDate.getMonth() + 1; // JavaScriptは0から始まる\n  \n  // 年月の初期値を設定\n  const initialYear = currentDate.getFullYear();\n  const initialMonth = currentMonthNumber;\n\n  // エラーメッセージ状態\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  // 成功メッセージ状態\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  // 新規作成フラグ\n  const [isCreatingNewReport, setIsCreatingNewReport] = useState<boolean>(false);\n\n  // データがキャッシュから使用されているかどうかのフラグ\n  const [isUsingCachedData, setIsUsingCachedData] = useState<boolean>(false);\n\n  // 年度ごとのデータキャッシュ\n  const [dataCache, setDataCache] = useState<{[key: string]: any}>({});\n\n  // データ状態\n  const [currentReport, setCurrentReport] = useState<{\n    summary: MonthlyTotal | null;\n    employees: Employee[];\n    detail: MonthlyDetailData | null;\n  }>({\n    summary: null,\n    employees: [],\n    detail: null\n  });\n\n  // タブ変更時のURL更新\n  useEffect(() => {\n    // URLのクエリパラメータを更新\n    navigate(`/monthly-report?tab=${activeTab}`, { replace: true });\n  }, [activeTab, navigate]);\n\n  // MonthlyReportContent コンポーネント - YearMonthContextを使用\n  const MonthlyReportContent: React.FC = () => {\n    const { fiscalYear, month, setFiscalYear, setMonth, dispatchYearMonthChange } = useYearMonth();\n  \n    // React Query - レポート一覧\n    const {\n      data: reportsList,\n      isLoading: isLoadingReportsList,\n      error: reportsListError\n    } = useQuery(\n      ['monthlyReports'],\n      () => getMonthlyReports(),\n      {\n        onSuccess: (data) => {\n          // 最新のレポートを取得\n          if (data && data.length > 0) {\n            const latestReport = data[0];\n            // 最新レポートの詳細を取得\n            queryClient.invalidateQueries(['monthlyReport', latestReport.fiscal_year, latestReport.month]);\n          }\n        },\n        staleTime: 5 * 60 * 1000, // 5分間はStaleとみなさない\n        cacheTime: 10 * 60 * 1000, // 10分間キャッシュを保持\n      }\n    );\n\n    // React Query - 月次レポート取得\n    const {\n      data: reportData,\n      isLoading: isLoadingReportData,\n      error: reportDataError,\n      refetch: refetchReportData\n    } = useQuery(\n      ['monthlyReport', fiscalYear, month],\n      async () => {\n        // 年月が有効値であることを確認\n        const validYear = fiscalYear || initialYear;\n        const validMonth = month || initialMonth;\n        \n        console.log(`年度${validYear}、月${validMonth}のデータ取得開始`);\n        \n        try {\n          // キャッシュキーを生成\n          const cacheKey = `${validYear}-${validMonth}`;\n          \n          // まず、キャッシュに既にデータがあるか確認\n          if (dataCache[cacheKey] && !isUsingCachedData) {\n            console.log(`${validYear}年${validMonth}月のキャッシュデータを使用します`);\n            setIsUsingCachedData(true);\n            return dataCache[cacheKey];\n          }\n          \n          // データ取得\n          const data = await getMonthlyReport(validYear, validMonth);\n          console.log('API応答:', data);\n          \n          // キャッシュを更新\n          setDataCache(prev => ({\n            ...prev,\n            [cacheKey]: data\n          }));\n          \n          setIsUsingCachedData(false);\n          return data;\n        } catch (error) {\n          // 404エラーの場合は新規作成モードに切り替え\n          if (axios.isAxiosError(error) && error.response?.status === 404) {\n            console.log(`${validYear}年${validMonth}月のデータが存在しません。新規作成モードに切替`);\n            setIsCreatingNewReport(true);\n            \n            // デフォルトの空データを自動生成\n            try {\n              await createDefaultMonthlyReport(validYear, validMonth);\n              // 再度データを取得\n              return await getMonthlyReport(validYear, validMonth);\n            } catch (createError) {\n              console.error('デフォルトデータの作成に失敗しました:', createError);\n              // 空のデータを返す\n              return {\n                success: true,\n                message: 'デフォルトデータを表示',\n                data: {\n                  summary: null,\n                  employees: [],\n                  detail: null\n                }\n              };\n            }\n          }\n          \n          // その他のエラーは再スロー\n          throw error;\n        }\n      },\n      {\n        onSuccess: (data) => {\n          // 新規作成モードの場合はリセット\n          if (isCreatingNewReport && data && data.success) {\n            setIsCreatingNewReport(false);\n          }\n          \n          if (data) {\n            // サマリーデータの安全な処理\n            const summaryData = data.data?.summary || null;\n            let detailData = data.data?.detail || null;\n            \n            // サマリーデータが存在する場合のみformatYearlyDataForUIを呼び出す\n            if (summaryData && !detailData) {\n              try {\n                detailData = formatYearlyDataForUI([summaryData]);\n              } catch (error) {\n                console.error(\"詳細データの生成中にエラーが発生しました:\", error);\n                detailData = null;\n              }\n            }\n            \n            // 従業員データが空の場合はサンプルデータを使用\n            const employeesData = data?.data?.employees && data.data.employees.length > 0 \n              ? data.data.employees \n              : sampleEmployees;\n            \n            setCurrentReport({\n              summary: summaryData,\n              employees: employeesData,\n              detail: detailData\n            });\n          } else {\n            // データがない場合はサンプルデータを使用\n            setCurrentReport({\n              summary: null,\n              employees: sampleEmployees,\n              detail: null\n            });\n          }\n        },\n        onError: (error) => {\n          console.error(\"月次レポートデータ取得エラー:\", error);\n          setErrorMessage('データの取得中にエラーが発生しました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          \n          // エラー時はサンプルデータを表示\n          setCurrentReport(prev => ({\n            ...prev,\n            employees: sampleEmployees\n          }));\n        },\n        enabled: !!fiscalYear && !!month, // 年月が設定されている場合のみクエリを実行\n        staleTime: 5 * 60 * 1000,\n        cacheTime: 10 * 60 * 1000,\n        retry: (failureCount, error) => {\n          // 404エラーの場合はリトライしない（存在しないデータ）\n          if (axios.isAxiosError(error) && error.response?.status === 404) {\n            return false;\n          }\n          // その他のエラーは3回までリトライ\n          return failureCount < 3;\n        }\n      }\n    );\n\n    // サマリーデータ更新ハンドラー\n    const handleSummaryChange = (updatedSummary: MonthlyTotal) => {\n      setCurrentReport(prev => ({\n        ...prev,\n        summary: updatedSummary\n      }));\n    };\n\n    // 従業員データ更新ハンドラー\n    const handleEmployeeChange = (id: number, field: string, value: string) => {\n      setCurrentReport(prev => {\n        if (!prev.employees) return prev;\n        \n        return {\n          ...prev,\n          employees: prev.employees.map(emp => \n            emp.id === id \n              ? { \n                  ...emp, \n                  [field]: field === 'monthlyStatus' ? \n                    (typeof value === 'string' ? JSON.parse(value) : value) : \n                    value \n                } \n              : emp\n          )\n        };\n      });\n    };\n\n    // 月次詳細更新ハンドラー\n    const handleDetailCellChange = (rowId: number, colIndex: number, value: string) => {\n      setCurrentReport(prev => {\n        if (!prev.detail) return prev;\n        \n        const newDetail = {...prev.detail};\n        const rowIndex = newDetail.data.findIndex(row => row.id === rowId);\n        \n        if (rowIndex !== -1 && colIndex < 12) {\n          // 法定雇用率フィールドの特別処理\n          const isLegalRateField = rowId === 11;\n          let numValue: number;\n          \n          if (isLegalRateField) {\n            // 小数点を含む値の処理\n            if (value === '' || value === '.') {\n              numValue = 0;\n            } else if (value.endsWith('.')) {\n              numValue = parseFloat(value + '0');\n            } else {\n              numValue = parseFloat(value);\n            }\n          } else {\n            // 通常の数値変換\n            numValue = value === '' ? 0 : Number(value);\n          }\n          \n          if (!isNaN(numValue)) {\n            const updatedValues = [...newDetail.data[rowIndex].values];\n            updatedValues[colIndex] = numValue;\n            \n            // 合計の再計算\n            updatedValues[12] = updatedValues.slice(0, 12).reduce((a, b) => a + b, 0);\n            \n            newDetail.data[rowIndex].values = updatedValues;\n          }\n        }\n        \n        return {\n          ...prev,\n          detail: newDetail\n        };\n      });\n    };\n\n    // データ再取得ハンドラー\n    const handleRefreshData = useCallback(() => {\n      // 現在の年月のキャッシュのみをクリア\n      const cacheKey = `${fiscalYear}-${month}`;\n      setDataCache(prev => {\n        const newCache = {...prev};\n        delete newCache[cacheKey];\n        return newCache;\n      });\n      \n      setIsUsingCachedData(false);\n      \n      // キャッシュを強制的に無効化\n      queryClient.invalidateQueries(['monthlyReport', fiscalYear, month]);\n      \n      // データを明示的に再取得\n      refetchReportData().catch(error => {\n        console.error('データ再取得エラー:', error);\n        setErrorMessage('データの再取得中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      });\n    }, [fiscalYear, month, queryClient, refetchReportData]);\n\n    // 年度変更ハンドラー\n    const handleYearChange = async (year: number) => {\n      console.log(`親コンポーネントで年度変更を検知: ${fiscalYear} → ${year}`);\n      \n      try {\n        // 無効な年度チェック\n        if (isNaN(year) || year <= 0) {\n          console.error('無効な年度が指定されました:', year);\n          setErrorMessage('無効な年度が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n        \n        // 指定した年度のデータが存在するかチェック\n        const exists = await checkReportExists(year, month);\n        \n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${year}年度${month}月のデータが存在しないため、新規作成します`);\n          \n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(year, month);\n            console.log(`${year}年度${month}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラーを無視して続行\n          }\n        }\n        \n        // YearMonthContextの年度を更新\n        setFiscalYear(year);\n        \n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${year}-${month}`;\n        setDataCache(prev => {\n          const newCache = {...prev};\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        \n        setIsUsingCachedData(false);\n        \n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', year, month]);\n      } catch (error) {\n        console.error('年度変更処理中にエラーが発生しました:', error);\n        \n        // エラーメッセージを表示\n        setErrorMessage('年度切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // 月変更ハンドラー\n    const handleMonthChange = async (newMonth: number) => {\n      console.log(`月変更を検知: ${month} → ${newMonth}`);\n      \n      try {\n        // 無効な月チェック\n        if (isNaN(newMonth) || newMonth < 1 || newMonth > 12) {\n          console.error('無効な月が指定されました:', newMonth);\n          setErrorMessage('無効な月が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n        \n        // 現在のステートを保存\n        const prevMonth = month;\n        \n        // 先にUIを更新して即時フィードバックを提供\n        setMonth(newMonth);\n        \n        // 指定した年月のデータが存在するかチェック\n        const exists = await checkReportExists(fiscalYear, newMonth);\n        \n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${fiscalYear}年度${newMonth}月のデータが存在しないため、新規作成します`);\n          \n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(fiscalYear, newMonth);\n            console.log(`${fiscalYear}年度${newMonth}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラー時はUIに通知するが、ステートは既に更新済み\n            setErrorMessage('新しい月のレポート作成中にエラーが発生しました。');\n            setTimeout(() => setErrorMessage(null), 5000);\n          }\n        }\n        \n        // イベント発火 - 年月の同時変更を通知\n        const yearMonthChangeEvent = new CustomEvent('yearMonthChanged', {\n          detail: { year: fiscalYear, month: newMonth }\n        });\n        window.dispatchEvent(yearMonthChangeEvent);\n        \n        // YearMonthContextの値を更新\n        dispatchYearMonthChange(fiscalYear, newMonth);\n        \n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${fiscalYear}-${newMonth}`;\n        setDataCache(prev => {\n          const newCache = {...prev};\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        \n        setIsUsingCachedData(false);\n        \n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', fiscalYear, newMonth]);\n        \n        // 成功メッセージを表示\n        setSuccessMessage(`${fiscalYear}年${newMonth}月のデータを表示しています`);\n        setTimeout(() => setSuccessMessage(null), 3000);\n      } catch (error) {\n        console.error('月変更処理中にエラーが発生しました:', error);\n        \n        // エラーメッセージを表示\n        setErrorMessage('月の切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // 年月の同時変更ハンドラー\n    const handleYearMonthChange = async (year: number, newMonth: number) => {\n      console.log(`年月変更を検知: ${fiscalYear}年${month}月 → ${year}年${newMonth}月`);\n      \n      try {\n        // 無効な年月チェック\n        if (isNaN(year) || year <= 0) {\n          console.error('無効な年度が指定されました:', year);\n          setErrorMessage('無効な年度が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n        \n        if (isNaN(newMonth) || newMonth < 1 || newMonth > 12) {\n          console.error('無効な月が指定されました:', newMonth);\n          setErrorMessage('無効な月が指定されました。');\n          setTimeout(() => setErrorMessage(null), 5000);\n          return;\n        }\n        \n        // 指定した年月のデータが存在するかチェック\n        const exists = await checkReportExists(year, newMonth);\n        \n        if (!exists) {\n          // データが存在しない場合は新規作成\n          console.log(`${year}年度${newMonth}月のデータが存在しないため、新規作成します`);\n          \n          // デフォルトデータを作成\n          try {\n            await createDefaultMonthlyReport(year, newMonth);\n            console.log(`${year}年度${newMonth}月のデータを新規作成しました`);\n          } catch (error) {\n            console.error('新規レポート作成エラー:', error);\n            // エラーを無視して続行\n          }\n        }\n        \n        // YearMonthContextの年度と月を同時に更新\n        dispatchYearMonthChange(year, newMonth);\n        \n        // 現在表示中のキャッシュをクリア\n        const cacheKey = `${year}-${newMonth}`;\n        setDataCache(prev => {\n          const newCache = {...prev};\n          delete newCache[cacheKey];\n          return newCache;\n        });\n        \n        setIsUsingCachedData(false);\n        \n        // キャッシュを強制的に無効化して再取得\n        queryClient.invalidateQueries(['monthlyReport', year, newMonth]);\n      } catch (error) {\n        console.error('年月変更処理中にエラーが発生しました:', error);\n        \n        // エラーメッセージを表示\n        setErrorMessage('年月の切り替え中にエラーが発生しました。');\n        setTimeout(() => setErrorMessage(null), 5000);\n      }\n    };\n\n    // タブ切り替えハンドラー\n    const handleTabChange = (tab: string) => {\n      setActiveTab(tab);\n      const params = new URLSearchParams(location.search);\n      params.set('tab', tab);\n      navigate(`${location.pathname}?${params.toString()}`, { replace: true });\n    };\n\n    // ローディングまたはエラー状態の処理\n    const isLoading = isLoadingReportsList || isLoadingReportData;\n    const hasError = reportsListError || reportDataError;\n\n    if (isLoading && !currentReport.summary && !currentReport.employees.length) {\n      return <Spinner />;\n    }\n\n    if (hasError && !currentReport.employees.length) {\n      console.error(\"データ取得エラー:\", { reportsListError, reportDataError });\n      return <ErrorMessage message=\"データの読み込み中にエラーが発生しました。\" />;\n    }\n\n    const { summary, employees, detail } = currentReport;\n    const isConfirmed = summary?.status === '確定済';\n\n    // タブ定義\n    const tabItems = [\n      { id: 'summary', label: 'サマリー' },\n      { id: 'employees', label: '従業員詳細' },\n      { id: 'monthly', label: '月次詳細' }\n    ];\n\n    // デフォルトのMonthlyTotal型オブジェクト\n    const defaultSummary: MonthlyTotal = {\n      fiscal_year: fiscalYear,\n      month: month,\n      employees_count: 0,\n      fulltime_count: 0,\n      parttime_count: 0,\n      level1_2_count: 0,\n      other_disability_count: 0,\n      level1_2_parttime_count: 0,\n      other_parttime_count: 0,\n      legal_employment_rate: 2.3,\n      total_disability_count: 0,\n      employment_rate: 0,\n      required_count: 0,\n      over_under_count: 0,\n      status: '未確定'\n    };\n\n    // 月選択用オプション\n    const monthOptions = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\n    // タブコンテンツをレンダリングするための関数\n    const renderTabContent = () => {\n      console.log('タブレンダリング:', {\n        activeTab,\n        employeesCount: employees?.length || 0,\n        hasSummary: !!summary\n      });\n\n      if (activeTab === 'summary') {\n        return (\n          <SummaryTab \n            summaryData={summary} \n            onSummaryChange={handleSummaryChange}\n            onRefreshData={handleRefreshData}\n          />\n        );\n      }\n      \n      if (activeTab === 'employees') {\n        return (\n          <EmployeesTab \n            employees={(employees || []).map(emp => ({\n              ...emp,\n              id: emp.id,\n              employee_id: emp.employee_id !== undefined ? String(emp.employee_id) : '', // number型をstring型に変換\n              disability_type: emp.disability_type || '', // undefinedの場合は空文字列に変換\n              disability: emp.disability || '', // 念のため\n              grade: emp.grade || '', // 念のため\n              name: emp.name || '', // 念のため\n              status: emp.status || '在籍', // 念のため\n              hire_date: emp.hire_date || new Date().toISOString().split('T')[0].replace(/-/g, '/') // 念のため\n            }))} \n            onEmployeeChange={handleEmployeeChange}\n            onEmployeesUpdate={(updatedEmployees) => {\n              console.log('子コンポーネントから従業員データ更新を受信:', updatedEmployees.length, '件');\n              // 型互換性のために必要なプロパティを追加\n              const typeCompatibleEmployees = updatedEmployees.map(emp => ({\n                ...emp,\n                no: emp.no || 0, // noが未定義の場合は0を設定して型互換性を確保\n              }));\n              \n              // イベントオブジェクトを生成して状態の同期を管理（デバッグ用識別値を追加）\n              const uniqueId = new Date().getTime(); \n              console.log(`[${uniqueId}] 親コンポーネントで状態更新開始`);\n              \n              // 非同期で状態更新を行い、無限ループを防ぐ\n              setTimeout(() => {\n                console.log(`[${uniqueId}] 親コンポーネントで状態更新実行`);\n                setCurrentReport(prev => {\n                  // 前の状態と新しい状態が実質的に同じ場合は更新しない\n                  if (JSON.stringify(prev.employees.map(e => e.id)) === \n                      JSON.stringify(typeCompatibleEmployees.map(e => e.id)) &&\n                      prev.employees.length === typeCompatibleEmployees.length) {\n                    console.log(`[${uniqueId}] 従業員データに変更がないため、状態更新をスキップ`);\n                    return prev;\n                  }\n                  \n                  console.log(`[${uniqueId}] 従業員データを更新:`, typeCompatibleEmployees.length, '件');\n                  return {\n                    ...prev,\n                    employees: typeCompatibleEmployees as any\n                  };\n                });\n              }, 100); // 100ms遅延で実行\n            }}\n            summaryData={summary || defaultSummary}\n            onRefreshData={handleRefreshData}\n            onYearChange={handleYearChange}\n          />\n        );\n      }\n      \n      if (activeTab === 'monthly') {\n        return (\n          <MonthlyReportDetail \n            isEmbedded={true}\n            summaryData={summary || undefined}\n            monthlyDetailData={detail || undefined}\n            onDetailCellChange={handleDetailCellChange}\n            onYearChange={handleYearChange}\n            onRefreshData={handleRefreshData}\n          />\n        );\n      }\n      \n      // データがない場合、各タブで新規作成UIを表示するためにnullを返す\n      return null;\n    };\n\n    // 条件付きレンダリング要素を事前に作成\n    const errorMessageElement = errorMessage ? (\n      <div className=\"error-message\" style={{ \n        backgroundColor: '#f8d7da', \n        color: '#721c24', \n        padding: '10px', \n        borderRadius: '4px', \n        marginBottom: '15px' \n      }}>\n        {errorMessage}\n      </div>\n    ) : null;\n\n    const successMessageElement = successMessage ? (\n      <div className=\"success-message\" style={{ \n        backgroundColor: '#d4edda', \n        color: '#155724', \n        padding: '10px', \n        borderRadius: '4px', \n        marginBottom: '15px' \n      }}>\n        {successMessage}\n      </div>\n    ) : null;\n\n    const hasErrorElement = hasError ? (\n      <div style={{ \n        backgroundColor: '#f8d7da', \n        color: '#721c24', \n        padding: '10px', \n        borderRadius: '4px', \n        marginBottom: '15px' \n      }}>\n        データの取得中にエラーが発生しました。\n      </div>\n    ) : null;\n\n    const isLoadingElement = isLoading ? (\n      <div style={{ \n        backgroundColor: '#e9ecef', \n        padding: '10px', \n        borderRadius: '4px', \n        marginBottom: '15px',\n        textAlign: 'center'\n      }}>\n        データを読み込み中...\n      </div>\n    ) : null;\n\n    // サマリー表示要素（タブがサマリーの場合のみ表示）\n    const summaryElement = summary && activeTab === 'summary' ? (\n      <div style={{\n        backgroundColor: '#e9f2ff',\n        padding: '15px 20px',\n        borderRadius: '8px',\n        marginBottom: '20px',\n        borderLeft: '4px solid #3a66d4',\n        fontSize: '0.9rem'\n      }}>\n        <h3 style={{ fontSize: '1.1rem', margin: '0 0 10px 0', color: '#3a66d4' }}>\n          {summary.fiscal_year}年 {summary.month}月 サマリー\n        </h3>\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '10px 20px' }}>\n          <span>常用労働者数: <strong>{summary.employees_count}</strong>名</span>\n          <span>|</span>\n          <span>うちフルタイム: {summary.fulltime_count}名</span>\n          <span>|</span>\n          <span>うちパートタイム: {summary.parttime_count}名</span>\n          <br />\n          <span>障害者数 (カウント): <strong>{safeNumber(summary.total_disability_count).toFixed(1)}</strong>名</span>\n          <span>|</span>\n          <span>実雇用率: <strong>{safeNumber(summary.employment_rate).toFixed(2)}</strong>%</span>\n          <span>|</span>\n          <span>法定雇用率: {safeNumber(summary.legal_employment_rate).toFixed(2)}%</span>\n          <span>|</span>\n          <span>法定雇用障害者数: {safeNumber(summary.required_count).toFixed(1)}名</span>\n          <span>|</span>\n          <span>不足数: <strong style={{ color: safeNumber(summary.over_under_count) < 0 ? 'red' : 'inherit' }}>{safeNumber(summary.over_under_count).toFixed(1)}</strong>名</span>\n        </div>\n      </div>\n    ) : null;\n\n    return (\n      <div className=\"monthly-report-container\" style={{ padding: '20px' }}>\n        <h1 style={{ marginBottom: '20px' }}>月次報告</h1>\n\n        {/* 年月選択パネル */}\n        <div style={{\n          display: 'flex',\n          gap: '20px',\n          marginBottom: '20px',\n          backgroundColor: '#f8f9fa',\n          padding: '10px 15px',\n          borderRadius: '4px',\n          border: '1px solid #ddd'\n        }}>\n          <div>\n            <label style={{ marginRight: '8px', fontSize: '0.9rem' }}>年度:</label>\n            <select\n              value={fiscalYear}\n              onChange={(e) => handleYearChange(parseInt(e.target.value, 10))}\n              style={{\n                padding: '6px 10px',\n                borderRadius: '4px',\n                border: '1px solid #ced4da',\n                fontSize: '0.9rem'\n              }}\n            >\n              {Array.from({ length: 11 }, (_, i) => currentDate.getFullYear() - 5 + i).map(year => (\n                <option key={year} value={year}>{year}</option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label style={{ marginRight: '8px', fontSize: '0.9rem' }}>月:</label>\n            <select\n              value={month}\n              onChange={(e) => handleMonthChange(parseInt(e.target.value, 10))}\n              style={{\n                padding: '6px 10px',\n                borderRadius: '4px',\n                border: '1px solid #ced4da',\n                fontSize: '0.9rem'\n              }}\n            >\n              {monthOptions.map(m => (\n                <option key={m} value={m}>{m}月</option>\n              ))}\n            </select>\n          </div>\n          \n          {/* デバッグ情報 - 開発環境のみ表示 */}\n          {process.env.NODE_ENV === 'development' && (\n            <div style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#666' }}>\n              年度: {fiscalYear}, 月: {month}\n            </div>\n          )}\n          \n          <button\n            onClick={handleRefreshData}\n            style={{\n              padding: '6px 12px',\n              backgroundColor: '#007bff',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            }}\n            disabled={isLoading}\n          >\n            更新\n          </button>\n        </div>\n        \n        {errorMessageElement}\n        {successMessageElement}\n        {hasErrorElement}\n        {isLoadingElement}\n        \n        {summaryElement}\n        \n        <div style={{\n          display: 'flex',\n          borderBottom: '1px solid #ddd',\n          marginBottom: '20px'\n        }}>\n          {tabItems.map(tab => (\n            <button\n              key={tab.id}\n              onClick={() => handleTabChange(tab.id)}\n              style={{\n                padding: '10px 20px',\n                background: 'none',\n                border: 'none',\n                borderBottom: activeTab === tab.id ? '3px solid #007bff' : '3px solid transparent',\n                marginBottom: '-1px',\n                color: activeTab === tab.id ? '#007bff' : '#666',\n                fontWeight: activeTab === tab.id ? 'bold' : 'normal',\n                cursor: 'pointer',\n                transition: 'color 0.2s, border-bottom-color 0.2s',\n                fontSize: '1rem',\n              }}\n            >\n              {tab.label}\n            </button>\n          ))}\n        </div>\n        \n        <div className=\"tab-content\">\n          {renderTabContent()}\n        </div>\n      </div>\n    );\n  };\n\n  // メインコンポーネントのレンダリング\n  return (\n    <YearMonthProvider initialYear={initialYear} initialMonth={initialMonth}>\n      <MonthlyReportContent />\n    </YearMonthProvider>\n  );\n};\n\nexport default MonthlyReport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}